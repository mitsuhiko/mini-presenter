{
  "id": "053d255a",
  "title": "Speaker notes support (files + API)",
  "tags": [
    "phase-2",
    "enhanced"
  ],
  "status": "pending",
  "created_at": "2026-01-27T08:58:46.695Z"
}

# Speaker Notes Support

Add speaker notes to the presenter view, loaded from:
1. Presentation API (`window.miniPresenter.getNotes()`)
2. External markdown files (fallback)

## Notes Sources (Priority Order)

### 1. Presentation API
```javascript
if (window.miniPresenter?.getNotes) {
  const notes = window.miniPresenter.getNotes(slideId);
}
```

### 2. External Files
```
presentation/
├── index.html
└── notes/
    ├── #1.md
    ├── #2.md
    └── #slide-intro.md
```

**Hash to filename mapping:**
- `#1` → `notes/#1.md`
- `#/2/1` → `notes/#-2-1.md` (replace `/` with `-`)
- `#slide-intro` → `notes/#slide-intro.md`

## Server Changes

### New API endpoint
```
GET /_/api/notes?hash=%231
→ { "notes": "# Speaker Notes\n\n- Point 1\n- Point 2" }
→ { "notes": null }  // if not found
```

### Implementation
1. Receive hash from query param
2. Sanitize: replace `/` with `-`
3. Look for `notes/{sanitized}.md` in presentation directory
4. Return content or null

## Presenter View Changes

1. When state updates, fetch notes from API
2. Display in notes panel (render markdown or plain text)
3. Handle loading state
4. Cache notes to avoid refetching

## Tasks
- [ ] Add notes API endpoint to server
- [ ] Implement hash → filename sanitization
- [ ] Add notes panel to presenter.html
- [ ] Fetch notes on slide change
- [ ] Render markdown (simple: just preserve whitespace, or use marked.js)
- [ ] Handle missing notes gracefully
- [ ] Add example notes files to demo presentation

## Depends on
- TODO-ff468100 (Basic presenter view)
- TODO-4ed14eaf (Demo presentation)
